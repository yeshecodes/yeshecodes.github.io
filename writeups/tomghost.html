<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ghostcat</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Tomghost</h1><br/><p></p><p>Started with nmap scan added --open, -p- and -A. Ports 8009 and 8080 initially stuck out.</p><p><img src="tomghost-images/72-1.png" alt="tomghost-images/72-1.png" /></p><p></p><p>Gobuster, nothing stood out to much except the potential manager dashboards potentially offering jsp upload vulns</p><p><img src="tomghost-images/72-2.png" alt="tomghost-images/72-2.png" /></p><p></p><p>Further enumeration port 8009 ajp</p><p><img src="tomghost-images/72-3.png" alt="tomghost-images/72-3.png" /></p><p></p><p>browsed to port 8080</p><p><img src="tomghost-images/72-4.png" alt="tomghost-images/72-4.png" /></p><p></p><p>/manager page gets unauthorized response</p><p><img src="tomghost-images/72-5.png" alt="tomghost-images/72-5.png" /></p><p></p><p>Used book hacktricks guide to attempt to bypass the block</p><p><a href="https://book.hacktricks.xyz/network-services-pentesting/8009-pentesting-apache-jserv-protocol-ajp">https://book.hacktricks.xyz/network-services-pentesting/8009-pentesting-apache-jserv-protocol-ajp</a></p><p><img src="tomghost-images/72-6.png" alt="tomghost-images/72-6.png" /></p><p></p><p>Able to port the web app from 8009 through localhost and got to the credentials box, but no luck with default credentials, brute seemed premature, without username</p><p><img src="tomghost-images/72-7.png" alt="tomghost-images/72-7.png" /></p><p></p><p>book hacktricks provided another vector which might reveal credentials</p><p><img src="tomghost-images/72-8.png" alt="tomghost-images/72-8.png" /></p><p></p><p><img src="tomghost-images/72-9.png" alt="tomghost-images/72-9.png" /></p><p>!Found credentials using this method user: sk...: 87....</p><p></p><p></p><p>Firstly tried to ssh with the credentials. Yes, it worked!</p><p></p><p>Found 2 files right away. Looks like a pgp file and a decrytion key.</p><p><img src="tomghost-images/72-10.png" alt="tomghost-images/72-10.png" /></p><p></p><p>Decided to do some manual enum before pursuing the obvious path.</p><p><img src="tomghost-images/72-11.png" alt="tomghost-images/72-11.png" /></p><p>Not much...</p><p><img src="tomghost-images/72-12.png" alt="tomghost-images/72-12.png" /></p><p>Not much...crontabs...not much...</p><p><img src="tomghost-images/72-13.png" alt="tomghost-images/72-13.png" /></p><p>found another user name....the first flag is in that user home directory and is readable!</p><p><img src="tomghost-images/72-14.png" alt="tomghost-images/72-14.png" /></p><p></p><p>not much more here...</p><p><img src="tomghost-images/72-15.png" alt="tomghost-images/72-15.png" /></p><p>...not much in these</p><p><img src="tomghost-images/72-16.png" alt="tomghost-images/72-16.png" /></p><p></p><p>decided to run enum just because, I have the PGP vector but interested to see if anything else shows up. Not much here...this stands out due to kernel version running (4.4.0)but decided to put it to the side.</p><p><img src="tomghost-images/72-17.png" alt="tomghost-images/72-17.png" /></p><p></p><p>back to the path...copied the pgp into a file on kali machine</p><p><img src="tomghost-images/72-18.png" alt="tomghost-images/72-18.png" /></p><p></p><p><img src="tomghost-images/72-19.png" alt="tomghost-images/72-19.png" /></p><p></p><p>search for gpg2john to create a hash of the pgp key for cracking by john</p><p></p><p><img src="tomghost-images/72-20.png" alt="tomghost-images/72-20.png" /></p><p></p><p><img src="tomghost-images/72-21.png" alt="tomghost-images/72-21.png" /></p><p></p><p>search for john to crack the pgp hash</p><p><img src="tomghost-images/72-22.png" alt="tomghost-images/72-22.png" /></p><p>Found the passphrase to decrypt the pgp key</p><p><img src="tomghost-images/72-23.png" alt="tomghost-images/72-23.png" /></p><p></p><p></p><p>decrypted the key, the file contains the credentials of the other user: Merlin.</p><p><img src="tomghost-images/72-24.png" alt="tomghost-images/72-24.png" /></p><p></p><p><img src="tomghost-images/72-25.png" alt="tomghost-images/72-25.png" /></p><p></p><p>switched user to merlin</p><p><img src="tomghost-images/72-26.png" alt="tomghost-images/72-26.png" /></p><p>checked merlins sudo privileges and check GTFObins for the code to /usr/bin/zip</p><p><img src="tomghost-images/72-27.png" alt="tomghost-images/72-27.png" /></p><p></p><p>run the code. Oh yeah! Got root!</p><p><img src="tomghost-images/72-28.png" alt="tomghost-images/72-28.png" /></p><p>cat the root flag.</p><p><img src="tomghost-images/72-29.png" alt="tomghost-images/72-29.png" /></p></div>
</body>
</html>
